# HomeServer Telegram Bot

Telegram bot –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–º–∞—à–Ω–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π qBittorrent, Jackett –∏ Matrix.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞** –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- üåä **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä—Ä–µ–Ω—Ç–∞–º–∏** —á–µ—Ä–µ–∑ qBittorrent
- üîç **–ü–æ–∏—Å–∫ —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤** —á–µ—Ä–µ–∑ Jackett
- üíª **–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** (CPU, RAM, –¥–∏—Å–∫)
- üè† **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Matrix —Å–µ—Ä–≤–µ—Ä–∞**

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
- `/help` - –ü–æ–º–æ—â—å –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/status` - –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- `/torrents` - –ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ—Ä—Ä–µ–Ω—Ç—ã
- `/search <query>` - –ü–æ–∏—Å–∫ —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤
- `/system` - –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repo-url>
cd telegram-bot

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
cp .env.example .env
nano .env  # –£–∫–∞–∑–∞—Ç—å BOT_TOKEN –∏ ALLOWED_CHAT_IDS

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d
```

–≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:
- **qBittorrent** (–ø–æ—Ä—Ç 8080) - —Ç–æ—Ä—Ä–µ–Ω—Ç-–∫–ª–∏–µ–Ω—Ç  
- **Jackett** (–ø–æ—Ä—Ç 9117) - –ø—Ä–æ–∫—Å–∏ –¥–ª—è —Ç–æ—Ä—Ä–µ–Ω—Ç-—Ç—Ä–µ–∫–µ—Ä–æ–≤
- **TorrServer** (–ø–æ—Ä—Ç 8090) - —Å—Ç—Ä–∏–º–∏–Ω–≥ —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤
- **Telegram Bot** - –≤–∞—à –±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

1. **qBittorrent**: –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8080
   - –õ–æ–≥–∏–Ω: `admin`, –ø–∞—Ä–æ–ª—å: `adminadmin`
   - –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

2. **Jackett**: –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:9117  
   - –î–æ–±–∞–≤—å—Ç–µ –∏–Ω–¥–µ–∫—Å–∞—Ç–æ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, RuTracker)
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ API –∫–ª—é—á –≤ .env —Ñ–∞–π–ª (`JACKETT_API_KEY`)

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç**: `docker-compose restart telegram-bot`

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev

# –°–±–æ—Ä–∫–∞
npm run build
npm start
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Docker Compose

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f telegram-bot
docker-compose logs -f qbittorrent
docker-compose logs -f jackett

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤
docker-compose pull
docker-compose up -d
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ë–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `ALLOWED_CHAT_IDS` –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫–æ–º–∞–Ω–¥
- –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- Timeout –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —Å–µ—Ä–≤–∏—Å–∞–º
- Non-root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ bot.ts              # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ config.ts           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ types.ts            # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ services/           # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–µ—Ä–≤–∏—Å–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ qbittorrent.ts
‚îÇ   ‚îú‚îÄ‚îÄ jackett.ts
‚îÇ   ‚îî‚îÄ‚îÄ matrix.ts
‚îú‚îÄ‚îÄ commands/           # –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ status.ts
‚îÇ   ‚îú‚îÄ‚îÄ torrents.ts
‚îÇ   ‚îú‚îÄ‚îÄ search.ts
‚îÇ   ‚îî‚îÄ‚îÄ system.ts
‚îî‚îÄ‚îÄ utils/
    ‚îî‚îÄ‚îÄ system.ts       # –°–∏—Å—Ç–µ–º–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
```

## API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### qBittorrent Web API
- –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ –∏ –≤–µ—Ä—Å–∏—è
- –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤
- –°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏/—Ä–∞–∑–¥–∞—á–∏

### Jackett API
- –ü–æ–∏—Å–∫ —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤ –ø–æ –≤—Å–µ–º –∏–Ω–¥–µ–∫—Å–∞—Ç–æ—Ä–∞–º
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏–¥–∞—Ö, –ø–∏—Ä–∞—Ö, —Ä–∞–∑–º–µ—Ä–µ
- –ú–∞–≥–Ω–∏—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏

### Matrix Server API
- –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–æ–º–Ω–∞—Ç (—Ç—Ä–µ–±—É–µ—Ç admin API)

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏:
- –í—Ö–æ–¥—è—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û—à–∏–±–∫–∏ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–∏—Å–∞–º

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- TypeScript 5+
- –î–æ—Å—Ç—É–ø –∫ qBittorrent Web UI
- –î–æ—Å—Ç—É–ø –∫ Jackett API
- –î–æ—Å—Ç—É–ø –∫ Matrix server (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT